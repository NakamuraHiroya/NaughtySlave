<#-----------------------------------------------------------------------------
[OverView]
-----------------------------------------------------------------------------#>
# CSVデータから指定した条件のオブジェクトを特定のキーでソートして返す関数。
# $CSVData |sort { $_.キー文字列 } -descending

## 引数1(Input):取得するCSVデータ
## 引数2(Operate):ソートしたいキー
## 引数3(Option):ソート順序(指定が無ければ昇順。降順にしたければ"降順")

## 使用例：#$example = Script/SortCSVData.ps1 $example キー文字列 

<#-----------------------------------------------------------------------------
[1. Define]
-----------------------------------------------------------------------------#>
<#-------------------------------------
[1-1. 引数取得]
-------------------------------------#>
if ($args[0]) {$CSVData = $args[0]} else {"CSVデータを渡して下さい。";exit}
if ($args[1]) {$SortStrings = $args[1]} else {$SortStrings = Read-Host "ソートしたいキーを入力して下さい。"}
if ($args[2]) {$Order = $args[2]}

<#-----------------------------------------------------------------------------
[2. GetSrc]
-----------------------------------------------------------------------------#>

<#-----------------------------------------------------------------------------
[3. CustomData]
-----------------------------------------------------------------------------#>
<#-------------------------------------
[3-1. ソート]
-------------------------------------#>
$CSVData = $CSVData |sort { $_."$SortStrings" } 
if ($Order -eq "降順") {$CSVData = $CSVData |sort { $_."$SortStrings" } -descending} 

<#-----------------------------------------------------------------------------
[4. PostDist]
-----------------------------------------------------------------------------#>
return $CSVData

exit

