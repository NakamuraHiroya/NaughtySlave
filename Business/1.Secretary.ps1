# 業務の指示をする、社長の次に偉くて凄腕秘書的なイメージ。

param($WorkDir=$BUSINESS_DIR,[Switch]$Auto,[Parameter(ValueFromPipeline)]$Operate=$(
<#-----------------------------------------------------------------------------
[1-1. 選択リスト定義]
-----------------------------------------------------------------------------#>
"3-1-1. ナビゲートしてもらう",
"3-3-1. DocManager呼び出し",
"3-3-2. TableManager呼び出し",
"3-3-3. ProjectManager呼び出し",
"3-3-4. 自動化実行"|

ogv -PassThru -Title "次に何をしますか？"),
<#-----------------------------------------------------------------------------
[1-2. 変数定義]
-----------------------------------------------------------------------------#>
 $NewWBSList=$(if(-not(Test-Path ./WBSList.csv)){Set-Content ./WBSList.csv "ProjectCode,WorkCode,TicketCode,StartDate,FinDate,isToday"};
 (ls */*/TicketList.csv).Fullname|%{$WBSList += ipcsv $_ -Encoding Default}),

<#-----------------------------------------------------------------------------
【2. GetSrc】
-----------------------------------------------------------------------------#>
<#-----------------------------------------------------------------------------
[2-1. 読み込みたいリスト読み込み]
-----------------------------------------------------------------------------#>
$ProjectList = $(ipcsv "C:\Users\hiroya\Business\ProjectList.csv" -Encoding Default)

<#-----------------------------------------------------------------------------
【3. Custom】
-----------------------------------------------------------------------------#>
)begin{pushd .;cd $WorkDir;"Ready" >> $LOG}process{switch($Operate){

<#---------------------------------------------------------------------------#>
"3-1-1. ナビゲートしてもらう"{
<#---------------------------------------------------------------------------#>
"
　DocManager:色んなところから業務に必要なデータやTable作成に必要なデータを取って来てくれます。
　TableManager:
　
　とりあえずDocManagerから順番に呼び出してみましょう。

"
<#---------------------------------------------------------------------------#>
}"3-3-1. DocManager呼び出し"{
<#---------------------------------------------------------------------------#>
"DocManager"

<#---------------------------------------------------------------------------#>
}"3-3-2. TableManager呼び出し"{
<#---------------------------------------------------------------------------#>
"TableManager"

<#---------------------------------------------------------------------------#>
}"3-3-3. ProjectManager呼び出し"{
<#---------------------------------------------------------------------------#>
ProjectManager -WorkDir $BUSINESS_DIR

<#---------------------------------------------------------------------------#>
}"3-3-4. 自動化実行"{
<#---------------------------------------------------------------------------#>
"runspaceにpoolされたobjectがぶわーって動くイメージ"

<#---------------------------------------------------------------------------#>
}default{
<#---------------------------------------------------------------------------#>
"キャンセルが押されたか、選択メニューに無い！"

}}}end{popd}




